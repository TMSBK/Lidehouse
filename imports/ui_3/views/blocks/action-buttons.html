<template name="Action_button">
  {{#if action.visible getOptions getDoc}}
    <a {{dataObject}} href="{{action.href getOptions getDoc}}" class="btn btn-{{btnSize}} btn-{{or (action.color getOptions getDoc) 'white'}} text-capitalize js-{{action.name}}" title="{{#unless long}}{{_ title}}{{/unless}}">
      <i class="{{action.icon getOptions getDoc}}"></i>{{#if long}} {{_ title}}{{/if}}
    </a>
  {{/if}}
</template>

<template name="Action_button_status_change">
    <div class="dropdown pull-left">
        <a href="" data-toggle="dropdown" class="dropdown-toggle btn btn-xs btn-white" title="{{#unless long}}{{_ 'statusChange'}}{{/unless}}">
          <i class="fa fa-cogs"></i> 
          <b class="caret"></b>
        </a>
        <ul class="slim-menu dropdown-menu pull-right animated fadeInDown m-t-xs">
        {{#each status in getDoc.possibleNextStatuses}}
            {{>Action_listitem options=(optionsWithNewStatus status) doc=doc collection=collection action=action}}
        {{/each}}
        </ul>
    </div>
</template>

<template name="Action_buttons_group">
  <div class="btn-group">
    {{#each action in _actions}}
        {{#if (equals action.name 'statusChange')}}
            {{>Action_button_status_change options=options doc=doc collection=collection action=action size=size}}
        {{else}}
            {{>Action_button options=options doc=doc collection=collection action=action size=size}}
        {{/if}}
    {{/each}}
  </div>
</template>

<!-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

<template name="Action_listitem">
  {{#let enabled=(and (action.visible getOptions getDoc) 'enabled')}}
    <li class={{enabled}}>
        <a {{dataObject}} href="{{action.href getOptions getDoc}}" class="text-capitalize js-{{action.name}}">
        <span class="{{#unless enabled}}text-disabled{{/unless}}">
            <i class="{{action.icon getOptions getDoc}}"></i> {{_ title}}
        </span>
        </a>
    </li>
  {{/let}}
</template>

<template name="Action_listitems_status_change">
    {{#each status in doc.possibleNextStatuses}}
        {{>Action_listitem options=(optionsWithNewStatus status) doc=doc collection=collection action=action}}
    {{/each}}
</template>

<template name="Action_buttons_dropdown_list">
  <ul class="slim-menu dropdown-menu pull-right animated fadeInDown m-t-xs" aria-labelledby="drop_{{getDoc._id}}">
    {{#each action in _actions}}
        {{#if (equals action.name 'statusChange')}}
            {{>Action_listitems_status_change options=options doc=doc collection=collection action=action}}
        {{else}}
            {{>Action_listitem options=options doc=doc collection=collection action=action}}
        {{/if}}
        {{#if needsDividerAfter action}}
          <li role="separator" class="divider"></li>
        {{/if}}
    {{else}}
        <span class="text-muted">{{_ 'No actions available'}}</span>
    {{/each}}
    </ul>
</template>

<template name="Action_buttons_dropdown">
  {{>Menu_overflow_guard}}
  <div id="container-dd-{{getDoc._id}}"> 
    <div class="dropdown js-menu {{getDoc.entitiyName}}" id="dd-{{getDoc._id}}"> 
        <button class="btn btn-xs btn-white dropdown-toggle drop-unfoll" type="button" id="drop_{{getDoc._id}}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        {{#if long}}{{_ 'Action buttons'}} {{/if}}<i class="glyphicon glyphicon-option-horizontal"></i>
        </button>
        {{>Action_buttons_dropdown_list}}
    </div>
  </div>
</template>
